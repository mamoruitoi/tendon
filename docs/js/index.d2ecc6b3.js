(function(){"use strict";var e={7603:function(e,n,t){var o=t(5130),a=t(6768),l=t(4232),u=t(144);const i={class:"container mt-4"},r={key:0},s={key:1},c={key:0,class:"text-center"},v={key:1},d={key:0},f=["onClick"],p={key:1},h={key:0},k={class:"question"},y=["onClick"],b={key:0},g={key:1,class:"hidden"},C={key:1},m={class:"navigation"},w=["disabled"],E=["disabled"];var O={__name:"App",setup(e){const n=(0,u.KR)(!1),t=(0,u.KR)(!0),O=(0,u.KR)({}),X=(0,u.KR)(null),_=(0,u.KR)(""),j=async()=>{const e=await fetch("https://tendon-auth.mamoruitoi.workers.dev/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:_.value})});if(e.ok){const t=await e.json(),o=t.token;A.value=o,localStorage.setItem("token",o),console.log("from authenticate, res.json(): ",t),n.value=!0,await T()}else X.value="パスワードが間違っています"},K=(0,u.KR)([]),x=(0,u.KR)(0),R=(0,a.EW)((()=>K.value&&K.value.length?K.value[x.value]:null)),L=(0,u.KR)({}),S=async()=>{t.value=!0;const e=O.value[I.value],n=await fetch("https://tendon-auth.mamoruitoi.workers.dev/notion",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A.value}`},body:JSON.stringify({page_id:e})}),o=await n.json();K.value=o.results,x.value=0,t.value=!1},T=async()=>{I.value=null,t.value=!0,console.log("token:",A.value);const e=await fetch("https://tendon-auth.mamoruitoi.workers.dev/notion",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A.value}`},body:JSON.stringify({page_id:"1efd0f4b272080fc9e5ff40c63eb6e28"})});if(!e.ok)throw new Error("トークンが無効です");n.value=!0;const o=await e.json();for(const n of o.results)n.child_page&&n.child_page.title&&n.id&&(O.value[n.child_page.title]=n.id);t.value=!1},I=(0,u.KR)(null),P=e=>{I.value=e,S()},A=(0,u.KR)(localStorage.getItem("token"));function J(e){L.value[e]=!L.value[e]}function z(){x.value<K.value.length-1&&x.value++}function B(){x.value>0&&x.value--}return(0,a.sV)((async()=>{if(!A.value)return n.value=!1,void(t.value=!1);try{await T()}catch(e){console.error(e),localStorage.removeItem("token"),n.value=!1,X.value="ログインに失敗しました"}finally{t.value=!1}})),(0,a.wB)(R,(()=>{L.value={}})),(e,u)=>((0,a.uX)(),(0,a.CE)("div",i,[t.value?((0,a.uX)(),(0,a.CE)("div",r,"読み込み中です...")):((0,a.uX)(),(0,a.CE)("div",s,[n.value?((0,a.uX)(),(0,a.CE)("div",v,[I.value||t.value?((0,a.uX)(),(0,a.CE)("div",p,[K.value.length&&R.value?((0,a.uX)(),(0,a.CE)("div",h,[(0,a.Lk)("div",k,[(0,a.Lk)("p",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(R.value.paragraph.rich_text,((e,n)=>((0,a.uX)(),(0,a.CE)("span",{key:n},[e.annotations.bold?((0,a.uX)(),(0,a.CE)("span",{key:0,class:"cloze",onClick:e=>J(n)},[L.value[n]?((0,a.uX)(),(0,a.CE)("strong",b,(0,l.v_)(e.text.content),1)):((0,a.uX)(),(0,a.CE)("strong",g,(0,l.v_)(e.text.content),1))],8,y)):((0,a.uX)(),(0,a.CE)("span",C,(0,l.v_)(e.text.content),1))])))),128))])]),(0,a.Lk)("div",m,[(0,a.Lk)("button",{onClick:B,disabled:0===x.value,class:"btn btn-outline-primary"},"戻る",8,w),(0,a.Lk)("button",{onClick:z,disabled:x.value===K.value.length-1,class:"btn btn-outline-primary"},"進む",8,E),(0,a.Lk)("button",{onClick:T,class:"btn btn-outline-secondary"},"一覧に戻る")])])):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",d,[u[1]||(u[1]=(0,a.Lk)("h4",null,"単元を選択してください",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Object.keys(O.value),(e=>((0,a.uX)(),(0,a.CE)("button",{key:e,class:"btn btn-outline-secondary m-1",onClick:n=>P(e)},(0,l.v_)(e),9,f)))),128))]))])):((0,a.uX)(),(0,a.CE)("div",c,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":u[0]||(u[0]=e=>_.value=e),type:"password",class:"form-control mb-2",placeholder:"パスワードを入力"},null,512),[[o.Jo,_.value]]),(0,a.Lk)("button",{onClick:j,class:"btn btn-primary"},"ログイン")]))]))]))}},X=t(1241);const _=(0,X.A)(O,[["__scopeId","data-v-85a24ef0"]]);var j=_;(0,o.Ef)(j).mount("#app")}},n={};function t(o){var a=n[o];if(void 0!==a)return a.exports;var l=n[o]={exports:{}};return e[o].call(l.exports,l,l.exports,t),l.exports}t.m=e,function(){var e=[];t.O=function(n,o,a,l){if(!o){var u=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],l=e[c][2];for(var i=!0,r=0;r<o.length;r++)(!1&l||u>=l)&&Object.keys(t.O).every((function(e){return t.O[e](o[r])}))?o.splice(r--,1):(i=!1,l<u&&(u=l));if(i){e.splice(c--,1);var s=a();void 0!==s&&(n=s)}}return n}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[o,a,l]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={57:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var a,l,u=o[0],i=o[1],r=o[2],s=0;if(u.some((function(n){return 0!==e[n]}))){for(a in i)t.o(i,a)&&(t.m[a]=i[a]);if(r)var c=r(t)}for(n&&n(o);s<u.length;s++)l=u[s],t.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return t.O(c)},o=self["webpackChunktendon"]=self["webpackChunktendon"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(7603)}));o=t.O(o)})();
//# sourceMappingURL=index.d2ecc6b3.js.map