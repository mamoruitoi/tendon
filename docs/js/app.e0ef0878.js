(function(){"use strict";var e={8389:function(e,n,t){var o=t(5130),a=t(6768),u=t(4232),l=t(144);const i={class:"container mt-4"},r={key:0},c={key:1,class:"text-center"},s={key:2},v={key:0},d=["onClick"],f={key:1},p={key:0},h={class:"question"},k=["onClick"],y={key:0},b={key:1},g={key:1},C={class:"navigation"},m=["disabled"],_=["disabled"];var w={__name:"App",setup(e){const n=(0,l.KR)(!1),t=(0,l.KR)(!0),w=(0,l.KR)({}),E=(0,l.KR)(null),O=(0,l.KR)(""),X=async()=>{const e=await fetch("https://tendon-auth.mamoruitoi.workers.dev/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:O.value})});if(e.ok){const t=await e.json(),o=t.token;P.value=o,localStorage.setItem("token",o),console.log("from authenticate, res.json(): ",t),n.value=!0,await S()}else E.value="パスワードが間違っています"},j=(0,l.KR)([]),K=(0,l.KR)(0),R=(0,a.EW)((()=>j.value&&j.value.length?j.value[K.value]:null)),x=(0,l.KR)({}),L=async()=>{t.value=!0;const e=w.value[T.value],n=await fetch("https://tendon-auth.mamoruitoi.workers.dev/notion",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P.value}`},body:JSON.stringify({page_id:e})}),o=await n.json();j.value=o.results,K.value=0,t.value=!1},S=async()=>{T.value=null,t.value=!0,console.log("token:",P.value);const e=await fetch("https://tendon-auth.mamoruitoi.workers.dev/notion",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P.value}`},body:JSON.stringify({page_id:"1efd0f4b272080fc9e5ff40c63eb6e28"})});if(!e.ok)throw new Error("トークンが無効です");n.value=!0;const o=await e.json();for(const n of o.results)n.child_page&&n.child_page.title&&n.id&&(w.value[n.child_page.title]=n.id);t.value=!1},T=(0,l.KR)(null),I=e=>{T.value=e,L()},P=(0,l.KR)(localStorage.getItem("token"));function A(e){x.value[e]=!x.value[e]}function J(){K.value<j.value.length-1&&K.value++}function z(){K.value>0&&K.value--}return(0,a.sV)((async()=>{if(!P.value)return n.value=!1,void(t.value=!1);try{await S()}catch(e){console.error(e),localStorage.removeItem("token"),n.value=!1,E.value="ログインに失敗しました"}finally{t.value=!1}})),(0,a.wB)(R,(()=>{x.value={}})),(e,l)=>((0,a.uX)(),(0,a.CE)("div",i,[t.value?((0,a.uX)(),(0,a.CE)("div",r,"読み込み中です...")):(0,a.Q3)("",!0),n.value?((0,a.uX)(),(0,a.CE)("div",s,[T.value||t.value?((0,a.uX)(),(0,a.CE)("div",f,[j.value.length&&R.value?((0,a.uX)(),(0,a.CE)("div",p,[(0,a.Lk)("div",h,[(0,a.Lk)("p",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(R.value.paragraph.rich_text,((e,n)=>((0,a.uX)(),(0,a.CE)("span",{key:n},[e.annotations.bold?((0,a.uX)(),(0,a.CE)("span",{key:0,class:"cloze",onClick:e=>A(n)},[x.value[n]?((0,a.uX)(),(0,a.CE)("strong",y,(0,u.v_)(e.text.content),1)):((0,a.uX)(),(0,a.CE)("u",b,"[__________]"))],8,k)):((0,a.uX)(),(0,a.CE)("span",g,(0,u.v_)(e.text.content),1))])))),128))])]),(0,a.Lk)("div",C,[(0,a.Lk)("button",{onClick:z,disabled:0===K.value},"戻る",8,m),(0,a.Lk)("button",{onClick:J,disabled:K.value===j.value.length-1},"進む",8,_),(0,a.Lk)("button",{onClick:S},"一覧に戻る")])])):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",v,[l[1]||(l[1]=(0,a.Lk)("h4",null,"単元を選択してください",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Object.keys(w.value),(e=>((0,a.uX)(),(0,a.CE)("button",{key:e,class:"btn btn-outline-secondary m-1",onClick:n=>I(e)},(0,u.v_)(e),9,d)))),128))]))])):((0,a.uX)(),(0,a.CE)("div",c,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>O.value=e),type:"password",class:"form-control mb-2",placeholder:"パスワードを入力"},null,512),[[o.Jo,O.value]]),(0,a.Lk)("button",{onClick:X,class:"btn btn-primary"},"ログイン")]))]))}},E=t(1241);const O=(0,E.A)(w,[["__scopeId","data-v-39105f94"]]);var X=O;(0,o.Ef)(X).mount("#app")}},n={};function t(o){var a=n[o];if(void 0!==a)return a.exports;var u=n[o]={exports:{}};return e[o].call(u.exports,u,u.exports,t),u.exports}t.m=e,function(){var e=[];t.O=function(n,o,a,u){if(!o){var l=1/0;for(s=0;s<e.length;s++){o=e[s][0],a=e[s][1],u=e[s][2];for(var i=!0,r=0;r<o.length;r++)(!1&u||l>=u)&&Object.keys(t.O).every((function(e){return t.O[e](o[r])}))?o.splice(r--,1):(i=!1,u<l&&(l=u));if(i){e.splice(s--,1);var c=a();void 0!==c&&(n=c)}}return n}u=u||0;for(var s=e.length;s>0&&e[s-1][2]>u;s--)e[s]=e[s-1];e[s]=[o,a,u]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={524:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var a,u,l=o[0],i=o[1],r=o[2],c=0;if(l.some((function(n){return 0!==e[n]}))){for(a in i)t.o(i,a)&&(t.m[a]=i[a]);if(r)var s=r(t)}for(n&&n(o);c<l.length;c++)u=l[c],t.o(e,u)&&e[u]&&e[u][0](),e[u]=0;return t.O(s)},o=self["webpackChunktendon"]=self["webpackChunktendon"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(8389)}));o=t.O(o)})();
//# sourceMappingURL=app.e0ef0878.js.map